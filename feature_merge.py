import pandas as pd
'''
wjy_train = pd.read_csv('wjy_train_feature.csv')
wjy_train.sort_values('area_id',inplace=True)
wjy_train.reset_index(drop=True,inplace=True)
wjy_train = wjy_train[['day_mean_num','u_day_mean_num','weekend_num_mean','weekday_num_mean','u_weekend_num_mean',
                      'u_weekday_num_mean','mg_num_mean','after_num_mean','eve_num_mean','night_num_mean',
                      'u_mg_num_mean','u_after_num_mean','u_eve_num_mean','u_night_num_mean','area_id']]
train = pd.read_csv('train_feature3.csv')
train = wjy_train.merge(train,on='area_id',how='inner')
print(train.shape)
train.to_csv('train_feature4.csv',index=False)

wjy_test = pd.read_csv('wjy_test_feature.csv')
wjy_test.sort_values('area_id',inplace=True)
wjy_test.reset_index(drop=True,inplace=True)
wjy_test = wjy_test[['day_mean_num','u_day_mean_num','weekend_num_mean','weekday_num_mean','u_weekend_num_mean',
                      'u_weekday_num_mean','mg_num_mean','after_num_mean','eve_num_mean','night_num_mean',
                      'u_mg_num_mean','u_after_num_mean','u_eve_num_mean','u_night_num_mean','area_id']]
test = pd.read_csv('test_feature3.csv')
test = wjy_test.merge(test,on='area_id',how='inner')
print(test.shape)
test.to_csv('test_feature4.csv',index=False)
'''
'''
#训练集  融合(hour层级 + day层级 + 组合特征)
train2 = pd.read_csv('train_feature2.csv')
train3 = pd.read_csv('train_feature3_.csv')  #这里若改为3_,后面就保存为5_
train5 = train2.merge(train3,on='area_id',how='inner')
train5['mean_A0_day0'] = train2['meanA0'] / (train3['day_mean0'] + 0.0001)
train5['mean_A1_day1'] = train2['meanA1'] / (train3['day_mean1'] + 0.0001)
train5['mean_A2_day2'] = train2['meanA2'] / (train3['day_mean2'] + 0.0001)
train5['mean_A3_day3'] = train2['meanA3'] / (train3['day_mean3'] + 0.0001)
train5['mean_A4_day4'] = train2['meanA4'] / (train3['day_mean4'] + 0.0001)
train5['mean_A5_day5'] = train2['meanA5'] / (train3['day_mean5'] + 0.0001)
train5['mean_A6_day6'] = train2['meanA6'] / (train3['day_mean6'] + 0.0001)
train5['mean_A7_day7'] = train2['meanA7'] / (train3['day_mean7'] + 0.0001)
train5.to_csv('train_feature5_.csv',index=False)
'''
'''
#测试集融合
train2 = pd.read_csv('test_feature2.csv')
train3 = pd.read_csv('test_feature3_.csv')
train5 = train2.merge(train3,on='area_id',how='inner')
train5['mean_A0_day0'] = train2['meanA0'] / (train3['day_mean0'] + 0.0001)
train5['mean_A1_day1'] = train2['meanA1'] / (train3['day_mean1'] + 0.0001)
train5['mean_A2_day2'] = train2['meanA2'] / (train3['day_mean2'] + 0.0001)
train5['mean_A3_day3'] = train2['meanA3'] / (train3['day_mean3'] + 0.0001)
train5['mean_A4_day4'] = train2['meanA4'] / (train3['day_mean4'] + 0.0001)
train5['mean_A5_day5'] = train2['meanA5'] / (train3['day_mean5'] + 0.0001)
train5['mean_A6_day6'] = train2['meanA6'] / (train3['day_mean6'] + 0.0001)
train5['mean_A7_day7'] = train2['meanA7'] / (train3['day_mean7'] + 0.0001)
train5.to_csv('test_feature5_.csv',index=False)
'''
'''
#训练集   融合(quarter层级特征+组合特征)
train = pd.read_csv('train_feature5_.csv')
train2 = pd.read_csv('train_feature4.csv')
train3 = train.merge(train2,on='area_id',how='inner')

train3['mean_qB0_B0'] = train3['q_meanB0'] / (train3['meanB0'] + 0.0001)
train3['mean_qC0_C0'] = train3['q_meanC0'] / (train3['meanC0'] + 0.0001)
train3['mean_qD0_D0'] = train3['q_meanD0'] / (train3['meanD0'] + 0.0001)
train3['mean_qE0_E0'] = train3['q_meanE0'] / (train3['meanE0'] + 0.0001)
train3['mean_qB0_day0'] = train3['q_meanB0'] / (train3['day_mean0'] + 0.001)
train3['mean_qC0_day0'] = train3['q_meanC0'] / (train3['day_mean0'] + 0.001)
train3['mean_qD0_day0'] = train3['q_meanD0'] / (train3['day_mean0'] + 0.001)
train3['mean_qE0_day0'] = train3['q_meanE0'] / (train3['day_mean0'] + 0.001)

train3['mean_qB0_B1'] = train3['q_meanB1'] / (train3['meanB1'] + 0.0001)
train3['mean_qC0_C1'] = train3['q_meanC1'] / (train3['meanC1'] + 0.0001)
train3['mean_qD0_D1'] = train3['q_meanD1'] / (train3['meanD1'] + 0.0001)
train3['mean_qE0_E1'] = train3['q_meanE1'] / (train3['meanE1'] + 0.0001)
train3['mean_qB0_day1'] = train3['q_meanB1'] / (train3['day_mean1'] + 0.001)
train3['mean_qC0_day1'] = train3['q_meanC1'] / (train3['day_mean1'] + 0.001)
train3['mean_qD0_day1'] = train3['q_meanD1'] / (train3['day_mean1'] + 0.001)
train3['mean_qE0_day1'] = train3['q_meanE1'] / (train3['day_mean1'] + 0.001)

train3['mean_qB0_B2'] = train3['q_meanB2'] / (train3['meanB2'] + 0.0001)
train3['mean_qC0_C2'] = train3['q_meanC2'] / (train3['meanC2'] + 0.0001)
train3['mean_qD0_D2'] = train3['q_meanD2'] / (train3['meanD2'] + 0.0001)
train3['mean_qE0_E2'] = train3['q_meanE2'] / (train3['meanE2'] + 0.0001)
train3['mean_qB0_day2'] = train3['q_meanB2'] / (train3['day_mean2'] + 0.001)
train3['mean_qC0_day2'] = train3['q_meanC2'] / (train3['day_mean2'] + 0.001)
train3['mean_qD0_day2'] = train3['q_meanD2'] / (train3['day_mean2'] + 0.001)
train3['mean_qE0_day2'] = train3['q_meanE2'] / (train3['day_mean2'] + 0.001)

train3['mean_qB0_B3'] = train3['q_meanB3'] / (train3['meanB3'] + 0.0001)
train3['mean_qC0_C3'] = train3['q_meanC3'] / (train3['meanC3'] + 0.0001)
train3['mean_qD0_D3'] = train3['q_meanD3'] / (train3['meanD3'] + 0.0001)
train3['mean_qE0_E3'] = train3['q_meanE3'] / (train3['meanE3'] + 0.0001)
train3['mean_qB0_day3'] = train3['q_meanB3'] / (train3['day_mean3'] + 0.001)
train3['mean_qC0_day3'] = train3['q_meanC3'] / (train3['day_mean3'] + 0.001)
train3['mean_qD0_day3'] = train3['q_meanD3'] / (train3['day_mean3'] + 0.001)
train3['mean_qE0_day3'] = train3['q_meanE3'] / (train3['day_mean3'] + 0.001)

train3['mean_qB0_B4'] = train3['q_meanB4'] / (train3['meanB4'] + 0.0001)
train3['mean_qC0_C4'] = train3['q_meanC4'] / (train3['meanC4'] + 0.0001)
train3['mean_qD0_D4'] = train3['q_meanD4'] / (train3['meanD4'] + 0.0001)
train3['mean_qE0_E4'] = train3['q_meanE4'] / (train3['meanE4'] + 0.0001)
train3['mean_qB0_day4'] = train3['q_meanB4'] / (train3['day_mean4'] + 0.001)
train3['mean_qC0_day4'] = train3['q_meanC4'] / (train3['day_mean4'] + 0.001)
train3['mean_qD0_day4'] = train3['q_meanD4'] / (train3['day_mean4'] + 0.001)
train3['mean_qE0_day4'] = train3['q_meanE4'] / (train3['day_mean4'] + 0.001)

train3['mean_qB0_B5'] = train3['q_meanB5'] / (train3['meanB5'] + 0.0001)
train3['mean_qC0_C5'] = train3['q_meanC5'] / (train3['meanC5'] + 0.0001)
train3['mean_qD0_D5'] = train3['q_meanD5'] / (train3['meanD5'] + 0.0001)
train3['mean_qE0_E5'] = train3['q_meanE5'] / (train3['meanE5'] + 0.0001)
train3['mean_qB0_day5'] = train3['q_meanB5'] / (train3['day_mean5'] + 0.001)
train3['mean_qC0_day5'] = train3['q_meanC5'] / (train3['day_mean5'] + 0.001)
train3['mean_qD0_day5'] = train3['q_meanD5'] / (train3['day_mean5'] + 0.001)
train3['mean_qE0_day5'] = train3['q_meanE5'] / (train3['day_mean5'] + 0.001)

train3['mean_qB0_B6'] = train3['q_meanB6'] / (train3['meanB6'] + 0.0001)
train3['mean_qC0_C6'] = train3['q_meanC6'] / (train3['meanC6'] + 0.0001)
train3['mean_qD0_D6'] = train3['q_meanD6'] / (train3['meanD6'] + 0.0001)
train3['mean_qE0_E6'] = train3['q_meanE6'] / (train3['meanE6'] + 0.0001)
train3['mean_qB0_day6'] = train3['q_meanB6'] / (train3['day_mean6'] + 0.001)
train3['mean_qC0_day6'] = train3['q_meanC6'] / (train3['day_mean6'] + 0.001)
train3['mean_qD0_day6'] = train3['q_meanD6'] / (train3['day_mean6'] + 0.001)
train3['mean_qE0_day6'] = train3['q_meanE6'] / (train3['day_mean6'] + 0.001)

train3['mean_qB0_B7'] = train3['q_meanB7'] / (train3['meanB7'] + 0.0001)
train3['mean_qC0_C7'] = train3['q_meanC7'] / (train3['meanC7'] + 0.0001)
train3['mean_qD0_D7'] = train3['q_meanD7'] / (train3['meanD7'] + 0.0001)
train3['mean_qE0_E7'] = train3['q_meanE7'] / (train3['meanE7'] + 0.0001)
train3['mean_qB0_day7'] = train3['q_meanB7'] / (train3['day_mean7'] + 0.001)
train3['mean_qC0_day7'] = train3['q_meanC7'] / (train3['day_mean7'] + 0.001)
train3['mean_qD0_day7'] = train3['q_meanD7'] / (train3['day_mean7'] + 0.001)
train3['mean_qE0_day7'] = train3['q_meanE7'] / (train3['day_mean7'] + 0.001)

train3.to_csv('train_feature6_.csv',index=False)
'''
#测试集 组合特征
train = pd.read_csv('test_feature5.csv')
del train['Unnamed: 0']
train2 = pd.read_csv('test_feature4.csv')
train3 = train.merge(train2,on='area_id',how='inner')

train3['mean_qB0_B0'] = train3['q_meanB0'] / (train3['meanB0'] + 0.0001)
train3['mean_qC0_C0'] = train3['q_meanC0'] / (train3['meanC0'] + 0.0001)
train3['mean_qD0_D0'] = train3['q_meanD0'] / (train3['meanD0'] + 0.0001)
train3['mean_qE0_E0'] = train3['q_meanE0'] / (train3['meanE0'] + 0.0001)
train3['mean_qB0_day0'] = train3['q_meanB0'] / (train3['day_mean0'] + 0.001)
train3['mean_qC0_day0'] = train3['q_meanC0'] / (train3['day_mean0'] + 0.001)
train3['mean_qD0_day0'] = train3['q_meanD0'] / (train3['day_mean0'] + 0.001)
train3['mean_qE0_day0'] = train3['q_meanE0'] / (train3['day_mean0'] + 0.001)

train3['mean_qB0_B1'] = train3['q_meanB1'] / (train3['meanB1'] + 0.0001)
train3['mean_qC0_C1'] = train3['q_meanC1'] / (train3['meanC1'] + 0.0001)
train3['mean_qD0_D1'] = train3['q_meanD1'] / (train3['meanD1'] + 0.0001)
train3['mean_qE0_E1'] = train3['q_meanE1'] / (train3['meanE1'] + 0.0001)
train3['mean_qB0_day1'] = train3['q_meanB1'] / (train3['day_mean1'] + 0.001)
train3['mean_qC0_day1'] = train3['q_meanC1'] / (train3['day_mean1'] + 0.001)
train3['mean_qD0_day1'] = train3['q_meanD1'] / (train3['day_mean1'] + 0.001)
train3['mean_qE0_day1'] = train3['q_meanE1'] / (train3['day_mean1'] + 0.001)

train3['mean_qB0_B2'] = train3['q_meanB2'] / (train3['meanB2'] + 0.0001)
train3['mean_qC0_C2'] = train3['q_meanC2'] / (train3['meanC2'] + 0.0001)
train3['mean_qD0_D2'] = train3['q_meanD2'] / (train3['meanD2'] + 0.0001)
train3['mean_qE0_E2'] = train3['q_meanE2'] / (train3['meanE2'] + 0.0001)
train3['mean_qB0_day2'] = train3['q_meanB2'] / (train3['day_mean2'] + 0.001)
train3['mean_qC0_day2'] = train3['q_meanC2'] / (train3['day_mean2'] + 0.001)
train3['mean_qD0_day2'] = train3['q_meanD2'] / (train3['day_mean2'] + 0.001)
train3['mean_qE0_day2'] = train3['q_meanE2'] / (train3['day_mean2'] + 0.001)

train3['mean_qB0_B3'] = train3['q_meanB3'] / (train3['meanB3'] + 0.0001)
train3['mean_qC0_C3'] = train3['q_meanC3'] / (train3['meanC3'] + 0.0001)
train3['mean_qD0_D3'] = train3['q_meanD3'] / (train3['meanD3'] + 0.0001)
train3['mean_qE0_E3'] = train3['q_meanE3'] / (train3['meanE3'] + 0.0001)
train3['mean_qB0_day3'] = train3['q_meanB3'] / (train3['day_mean3'] + 0.001)
train3['mean_qC0_day3'] = train3['q_meanC3'] / (train3['day_mean3'] + 0.001)
train3['mean_qD0_day3'] = train3['q_meanD3'] / (train3['day_mean3'] + 0.001)
train3['mean_qE0_day3'] = train3['q_meanE3'] / (train3['day_mean3'] + 0.001)

train3['mean_qB0_B4'] = train3['q_meanB4'] / (train3['meanB4'] + 0.0001)
train3['mean_qC0_C4'] = train3['q_meanC4'] / (train3['meanC4'] + 0.0001)
train3['mean_qD0_D4'] = train3['q_meanD4'] / (train3['meanD4'] + 0.0001)
train3['mean_qE0_E4'] = train3['q_meanE4'] / (train3['meanE4'] + 0.0001)
train3['mean_qB0_day4'] = train3['q_meanB4'] / (train3['day_mean4'] + 0.001)
train3['mean_qC0_day4'] = train3['q_meanC4'] / (train3['day_mean4'] + 0.001)
train3['mean_qD0_day4'] = train3['q_meanD4'] / (train3['day_mean4'] + 0.001)
train3['mean_qE0_day4'] = train3['q_meanE4'] / (train3['day_mean4'] + 0.001)

train3['mean_qB0_B5'] = train3['q_meanB5'] / (train3['meanB5'] + 0.0001)
train3['mean_qC0_C5'] = train3['q_meanC5'] / (train3['meanC5'] + 0.0001)
train3['mean_qD0_D5'] = train3['q_meanD5'] / (train3['meanD5'] + 0.0001)
train3['mean_qE0_E5'] = train3['q_meanE5'] / (train3['meanE5'] + 0.0001)
train3['mean_qB0_day5'] = train3['q_meanB5'] / (train3['day_mean5'] + 0.001)
train3['mean_qC0_day5'] = train3['q_meanC5'] / (train3['day_mean5'] + 0.001)
train3['mean_qD0_day5'] = train3['q_meanD5'] / (train3['day_mean5'] + 0.001)
train3['mean_qE0_day5'] = train3['q_meanE5'] / (train3['day_mean5'] + 0.001)

train3['mean_qB0_B6'] = train3['q_meanB6'] / (train3['meanB6'] + 0.0001)
train3['mean_qC0_C6'] = train3['q_meanC6'] / (train3['meanC6'] + 0.0001)
train3['mean_qD0_D6'] = train3['q_meanD6'] / (train3['meanD6'] + 0.0001)
train3['mean_qE0_E6'] = train3['q_meanE6'] / (train3['meanE6'] + 0.0001)
train3['mean_qB0_day6'] = train3['q_meanB6'] / (train3['day_mean6'] + 0.001)
train3['mean_qC0_day6'] = train3['q_meanC6'] / (train3['day_mean6'] + 0.001)
train3['mean_qD0_day6'] = train3['q_meanD6'] / (train3['day_mean6'] + 0.001)
train3['mean_qE0_day6'] = train3['q_meanE6'] / (train3['day_mean6'] + 0.001)

train3['mean_qB0_B7'] = train3['q_meanB7'] / (train3['meanB7'] + 0.0001)
train3['mean_qC0_C7'] = train3['q_meanC7'] / (train3['meanC7'] + 0.0001)
train3['mean_qD0_D7'] = train3['q_meanD7'] / (train3['meanD7'] + 0.0001)
train3['mean_qE0_E7'] = train3['q_meanE7'] / (train3['meanE7'] + 0.0001)
train3['mean_qB0_day7'] = train3['q_meanB7'] / (train3['day_mean7'] + 0.001)
train3['mean_qC0_day7'] = train3['q_meanC7'] / (train3['day_mean7'] + 0.001)
train3['mean_qD0_day7'] = train3['q_meanD7'] / (train3['day_mean7'] + 0.001)
train3['mean_qE0_day7'] = train3['q_meanE7'] / (train3['day_mean7'] + 0.001)

train3.to_csv('test_feature6.csv',index=False)

